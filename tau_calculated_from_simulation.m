%% Calculation of tau using data from simulation
% mesh chosen: 0.02 global seed size

%% Original widths:
% Epsilon_pre = 0.1

% x_def = [2.03E-02, 2.07E-02, 1.93E-02, 1.52E-02, 9.91E-03, 4.28E-03, -1.54E-03, -7.29E-03, -1.25E-02, -1.67E-02, -1.95E-02, -2.05E-02, -1.97E-02, -1.71E-02, -1.32E-02, -8.02E-03, -2.22E-03, 3.80E-03, 9.47E-03, 1.43E-02, 1.79E-02, 2.00E-02, 2.03E-02, 1.89E-02, 1.59E-02, 1.14E-02, 6.02E-03, 9.24E-05, -5.87E-03, -1.13E-02, -1.58E-02, -1.89E-02, -2.04E-02, -2.00E-02, -1.81E-02, -1.45E-02, -9.68E-03, -3.97E-03, 1.92E-03, 7.83E-03, 1.28E-02, 1.70E-02, 1.94E-02, 2.09E-02, 2.00E-02, 1.88E-02, 1.51E-02, 1.23E-02, 8.01E-03, 6.71E-03, 5.00E-03];
% y_def = [-6.36E-03, 1.20E-03, 8.87E-03, 1.47E-02, 1.83E-02, 2.00E-02, 2.03E-02, 1.90E-02, 1.61E-02, 1.17E-02, 6.34E-03, 3.06E-04, -5.65E-03, -1.12E-02, -1.56E-02, -1.88E-02, -2.03E-02, -2.01E-02, -1.81E-02, -1.46E-02, -9.77E-03, -4.14E-03, 1.87E-03, 7.70E-03, 1.29E-02, 1.69E-02, 1.95E-02, 2.04E-02, 1.96E-02, 1.70E-02, 1.30E-02, 7.86E-03, 2.05E-03, -3.96E-03, -9.61E-03, -1.45E-02, -1.80E-02, -2.01E-02, -2.03E-02, -1.90E-02, -1.59E-02, -1.17E-02, -6.45E-03, -8.27E-04, 4.85E-03, 1.02E-02, 1.45E-02, 1.79E-02, 2.00E-02, 2.08E-02, 2.00E-02];
% z_def = [8.90E-01, 8.74E-01, 8.56E-01, 8.39E-01, 8.21E-01, 8.03E-01, 7.86E-01, 7.68E-01, 7.50E-01, 7.32E-01, 7.14E-01, 6.96E-01, 6.78E-01, 6.60E-01, 6.43E-01, 6.25E-01, 6.07E-01, 5.89E-01, 5.71E-01, 5.53E-01, 5.35E-01, 5.18E-01, 5.00E-01, 4.82E-01, 4.64E-01, 4.46E-01, 4.28E-01, 4.10E-01, 3.93E-01, 3.75E-01, 3.57E-01, 3.39E-01, 3.21E-01, 3.03E-01, 2.85E-01, 2.68E-01, 2.50E-01, 2.32E-01, 2.14E-01, 1.96E-01, 1.78E-01, 1.60E-01, 1.43E-01, 1.25E-01, 1.07E-01, 8.89E-02, 7.12E-02, 5.32E-02, 3.58E-02, 1.76E-02, 0.00E+00];

% Epsilon_pre = 0.2

%x_def = [1.82E-02,  1.12E-02,  2.64E-03,  -6.27E-03,  -1.33E-02,  -1.78E-02,  -2.03E-02,  -1.93E-02,  -1.55E-02,  -8.75E-03,  -8.56E-04,  7.41E-03,  1.42E-02,  1.89E-02,  2.04E-02,  1.87E-02,  1.38E-02,  6.81E-03,  -1.39E-03,  -9.28E-03,  -1.57E-02,  -1.96E-02,  -2.03E-02,  -1.76E-02,  -1.22E-02,  -4.70E-03,  3.48E-03,  1.12E-02,  1.70E-02,  2.01E-02,  1.99E-02,  1.65E-02,  1.04E-02,  2.66E-03,  -5.66E-03,  -1.28E-02,  -1.82E-02,  -2.03E-02,  -1.94E-02,  -1.51E-02,  -8.62E-03,  -4.31E-04,  7.27E-03,  1.47E-02,  1.86E-02,  2.18E-02,  1.91E-02,  1.74E-02,  1.02E-02,  8.42E-03,  5.00E-03];
%y_def = [1.13E-02,  1.69E-02,  2.08E-02,  2.00E-02,  1.59E-02,  9.53E-03,  1.93E-03,  -6.23E-03,  -1.33E-02,  -1.85E-02,  -2.04E-02,  -1.91E-02,  -1.46E-02,  -7.79E-03,  3.13E-04,  8.32E-03,  1.50E-02,  1.93E-02,  2.04E-02,  1.82E-02,  1.30E-02,  5.76E-03,  -2.44E-03,  -1.03E-02,  -1.64E-02,  -1.99E-02,  -2.01E-02,  -1.71E-02,  -1.13E-02,  -3.67E-03,  4.57E-03,  1.20E-02,  1.76E-02,  2.02E-02,  1.97E-02,  1.58E-02,  9.45E-03,  1.52E-03,  -6.60E-03,  -1.38E-02,  -1.85E-02,  -2.06E-02,  -1.90E-02,  -1.49E-02,  -8.08E-03,  -2.07E-04,  7.68E-03,  1.48E-02,  1.99E-02,  2.14E-02,  2.00E-02];
%z_def = [7.77E-01,  7.64E-01,  7.49E-01,  7.34E-01,  7.19E-01,  7.03E-01,  6.87E-01,  6.71E-01,  6.56E-01,  6.40E-01,  6.24E-01,  6.09E-01,  5.93E-01,  5.78E-01,  5.62E-01,  5.46E-01,  5.31E-01,  5.15E-01,  4.99E-01,  4.84E-01,  4.68E-01,  4.53E-01,  4.37E-01,  4.21E-01,  4.06E-01,  3.90E-01,  3.74E-01,  3.59E-01,  3.43E-01,  3.27E-01,  3.12E-01,  2.96E-01,  2.81E-01,  2.65E-01,  2.49E-01,  2.34E-01,  2.18E-01,  2.02E-01,  1.87E-01,  1.71E-01,  1.55E-01,  1.40E-01,  1.24E-01,  1.09E-01,  9.31E-02,  7.73E-02,  6.22E-02,  4.60E-02,  3.14E-02,  1.49E-02,  0.00E+00];

% Epsilon_pre = 0.3
%x_def = [-7.80E-03,  7.31E-04,  9.24E-03,  1.68E-02,  2.02E-02,  1.87E-02,  1.47E-02,  6.93E-03,  -1.64E-03,  -1.06E-02,  -1.67E-02,  -1.99E-02,  -1.86E-02,  -1.38E-02,  -5.98E-03,  2.87E-03,  1.13E-02,  1.73E-02,  1.99E-02,  1.83E-02,  1.30E-02,  5.04E-03,  -3.95E-03,  -1.21E-02,  -1.78E-02,  -1.99E-02,  -1.79E-02,  -1.22E-02,  -4.07E-03,  5.01E-03,  1.29E-02,  1.83E-02,  1.98E-02,  1.74E-02,  1.13E-02,  3.12E-03,  -6.07E-03,  -1.36E-02,  -1.87E-02,  -1.97E-02,  -1.69E-02,  -1.04E-02,  -2.31E-03,  7.15E-03,  1.37E-02,  2.05E-02,  1.98E-02,  2.02E-02,  1.13E-02,  1.00E-02,  5.00E-03];
%y_def = [-1.98E-02,  -1.93E-02,  -1.73E-02,  -1.12E-02,  -2.66E-03,  5.66E-03,  1.35E-02,  1.85E-02,  1.97E-02,  1.69E-02,  1.06E-02,  2.09E-03,  -6.83E-03,  -1.43E-02,  -1.89E-02,  -1.97E-02,  -1.64E-02,  -9.73E-03,  -1.07E-03,  7.77E-03,  1.51E-02,  1.92E-02,  1.95E-02,  1.57E-02,  8.81E-03,  2.34E-05,  -8.70E-03,  -1.57E-02,  -1.94E-02,  -1.93E-02,  -1.51E-02,  -7.86E-03,  1.02E-03,  9.59E-03,  1.64E-02,  1.96E-02,  1.90E-02,  1.44E-02,  6.89E-03,  -2.11E-03,  -1.05E-02,  -1.70E-02,  -1.96E-02,  -1.90E-02,  -1.39E-02,  -6.44E-03,  2.96E-03,  1.25E-02,  2.02E-02,  2.17E-02,  2.00E-02];
%z_def = [6.75E-01,  6.66E-01,  6.54E-01,  6.39E-01,  6.26E-01,  6.12E-01,  5.98E-01,  5.85E-01,  5.71E-01,  5.57E-01,  5.44E-01,  5.30E-01,  5.17E-01,  5.03E-01,  4.89E-01,  4.76E-01,  4.62E-01,  4.48E-01,  4.35E-01,  4.21E-01,  4.07E-01,  3.94E-01,  3.80E-01,  3.66E-01,  3.53E-01,  3.39E-01,  3.26E-01,  3.12E-01,  2.98E-01,  2.85E-01,  2.71E-01,  2.57E-01,  2.44E-01,  2.30E-01,  2.16E-01,  2.03E-01,  1.89E-01,  1.75E-01,  1.62E-01,  1.48E-01,  1.35E-01,  1.21E-01,  1.07E-01,  9.39E-02,  8.00E-02,  6.62E-02,  5.35E-02,  3.92E-02,  2.73E-02,  1.24E-02,  0.00E+00];

% Epsilon_pre = 0.4

%x_def =[-1.87E-02,  -1.28E-02,  -6.45E-03,  3.05E-03,  1.19E-02,  1.64E-02,  1.89E-02,  1.67E-02,  1.13E-02,  2.89E-03,  -5.66E-03,  -1.34E-02,  -1.79E-02,  -1.86E-02,  -1.52E-02,  -8.60E-03,  6.06E-05,  8.54E-03,  1.53E-02,  1.86E-02,  1.79E-02,  1.32E-02,  1.32E-02,  5.73E-03,  -3.06E-03,  -1.12E-02,  -1.68E-02,  -1.88E-02,  -1.67E-02,  -1.09E-02,  -2.69E-03,  5.95E-03,  1.35E-02,  1.79E-02,  1.86E-02,  1.50E-02,  8.40E-03,  -4.34E-04,  -8.65E-03,  -1.55E-02,  -1.86E-02,  -1.78E-02,  -1.30E-02,  -5.70E-03,  3.56E-03,  1.05E-02,  1.88E-02,  1.91E-02,  2.16E-02,  1.16E-02,  1.15E-02];
%y_def = [-8.57E-03,  -1.29E-02,  -1.69E-02,  -1.86E-02,  -1.56E-02,  -8.60E-03,  -3.56E-04,  8.53E-03,  1.49E-02,  1.88E-02,  1.78E-02,  1.35E-02,  5.75E-03,  -2.81E-03,  -1.11E-02,  -1.67E-02,  -1.89E-02,  -1.67E-02,  -1.11E-02,  -2.86E-03,  5.87E-03,  1.34E-02,  1.34E-02,  1.79E-02,  1.86E-02,  1.52E-02,  8.42E-03,  -1.47E-04,  -8.72E-03,  -1.53E-02,  -1.87E-02,  -1.78E-02,  -1.32E-02,  -5.58E-03,  3.16E-03,  1.13E-02,  1.68E-02,  1.89E-02,  1.66E-02,  1.08E-02,  2.55E-03,  -6.09E-03,  -1.38E-02,  -1.79E-02,  -1.89E-02,  -1.50E-02,  -8.59E-03,  6.52E-04,  1.17E-02,  2.08E-02,  2.18E-02];
%z_def = [5.87E-01,  5.80E-01,  5.71E-01,  5.57E-01,  5.47E-01,  5.34E-01,  5.22E-01,  5.11E-01,  4.98E-01,  4.86E-01,  4.75E-01,  4.63E-01,  4.51E-01,  4.39E-01,  4.27E-01,  4.15E-01,  4.03E-01,  3.91E-01,  3.79E-01,  3.67E-01,  3.55E-01,  3.43E-01,  3.43E-01,  3.31E-01,  3.19E-01,  3.07E-01,  2.95E-01,  2.83E-01,  2.72E-01,  2.60E-01,  2.48E-01,  2.36E-01,  2.24E-01,  2.12E-01,  2.00E-01,  1.88E-01,  1.76E-01,  1.64E-01,  1.52E-01,  1.40E-01,  1.28E-01,  1.16E-01,  1.05E-01,  9.23E-02,  8.10E-02,  6.84E-02,  5.67E-02,  4.59E-02,  3.30E-02,  2.37E-02,  9.94E-03];

% Epsilon_pre = 0.5

%x_def = [-1.66E-02,  -1.15E-02,  -6.42E-03,  2.44E-03,  1.09E-02,  1.50E-02,  1.74E-02,  1.55E-02,  1.06E-02,  3.00E-03,  -4.81E-03,  -1.20E-02,  -1.62E-02,  -1.72E-02,  -1.41E-02,  -8.27E-03,  -3.62E-04,  7.43E-03,  1.38E-02,  1.70E-02,  1.66E-02,  1.25E-02,  5.73E-03,  -2.31E-03,  -9.81E-03,  -1.52E-02,  -1.73E-02,  -1.55E-02,  -1.05E-02,  -3.04E-03,  4.90E-03,  1.20E-02,  1.62E-02,  1.71E-02,  1.41E-02,  8.27E-03,  2.60E-04,  -7.32E-03,  -1.38E-02,  -1.70E-02,  -1.65E-02,  -1.24E-02,  -5.89E-03,  2.58E-03,  9.23E-03,  1.79E-02,  1.84E-02,  2.21E-02,  1.11E-02,  1.29E-02,  5.00E-03];
%y_def = [-9.46E-03,  -1.21E-02,  -1.52E-02,  -1.69E-02,  -1.46E-02,  -8.12E-03,  -5.78E-04,  7.62E-03,  1.33E-02,  1.73E-02,  1.63E-02,  1.27E-02,  5.61E-03,  -2.16E-03,  -9.90E-03,  -1.51E-02,  -1.73E-02,  -1.55E-02,  -1.05E-02,  -3.08E-03,  4.93E-03,  1.19E-02,  1.63E-02,  1.71E-02,  1.42E-02,  8.19E-03,  4.14E-04,  -7.51E-03,  -1.37E-02,  -1.70E-02,  -1.65E-02,  -1.25E-02,  -5.70E-03,  2.29E-03,  9.90E-03,  1.51E-02,  1.73E-02,  1.55E-02,  1.05E-02,  3.01E-03,  -4.88E-03,  -1.23E-02,  -1.61E-02,  -1.74E-02,  -1.41E-02,  -8.35E-03,  3.27E-04,  1.22E-02,  2.13E-02,  2.12E-02,  2.00E-02];
%z_def = [5.12E-01,  5.06E-01,  5.00E-01,  4.87E-01,  4.79E-01,  4.67E-01,  4.57E-01,  4.47E-01,  4.36E-01,  4.26E-01,  4.15E-01,  4.04E-01,  3.94E-01,  3.84E-01,  3.73E-01,  3.63E-01,  3.52E-01,  3.42E-01,  3.31E-01,  3.21E-01,  3.10E-01,  3.00E-01,  2.89E-01,  2.79E-01,  2.68E-01,  2.58E-01,  2.47E-01,  2.37E-01,  2.26E-01,  2.16E-01,  2.05E-01,  1.95E-01,  1.84E-01,  1.74E-01,  1.63E-01,  1.53E-01,  1.43E-01,  1.32E-01,  1.22E-01,  1.11E-01,  1.01E-01,  9.02E-02,  7.94E-02,  6.96E-02,  5.83E-02,  4.85E-02,  3.92E-02,  2.76E-02,  2.03E-02,  7.83E-03,  0.00E+00];


%% Thin widths
% Epsilon_pre = 0.020

%x_def = [1.52E-02,  1.31E-02,  1.14E-02,  9.96E-03,  8.63E-03,  7.52E-03,  6.51E-03,  5.67E-03,  4.92E-03,  4.30E-03,  3.74E-03,  3.29E-03,  2.90E-03,  2.58E-03,  2.31E-03,  2.10E-03,  1.93E-03,  1.80E-03,  1.69E-03,  1.62E-03,  1.57E-03,  1.54E-03,  1.53E-03,  1.53E-03,  1.54E-03,  1.57E-03,  1.60E-03,  1.63E-03,  1.67E-03,  1.72E-03,  1.76E-03,  1.82E-03,  1.86E-03,  1.92E-03,  1.97E-03,  2.02E-03,  2.07E-03,  2.12E-03,  2.16E-03,  2.22E-03,  2.25E-03,  2.31E-03,  2.33E-03,  2.39E-03,  2.40E-03,  2.46E-03,  2.46E-03,  2.53E-03,  2.50E-03,  2.59E-03,  2.50E-03];
%y_def = [1.45E-02,  1.57E-02,  1.68E-02,  1.76E-02,  1.82E-02,  1.87E-02,  1.91E-02,  1.94E-02,  1.96E-02,  1.97E-02,  1.99E-02,  2.00E-02,  2.00E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.01E-02,  2.00E-02];
%z_def = [9.88E-01,  9.69E-01,  9.49E-01,  9.30E-01,  9.10E-01,  8.90E-01,  8.71E-01,  8.51E-01,  8.31E-01,  8.12E-01,  7.92E-01,  7.72E-01,  7.52E-01,  7.33E-01,  7.13E-01,  6.93E-01,  6.73E-01,  6.53E-01,  6.34E-01,  6.14E-01,  5.94E-01,  5.74E-01,  5.54E-01,  5.35E-01,  5.15E-01,  4.95E-01,  4.75E-01,  4.55E-01,  4.36E-01,  4.16E-01,  3.96E-01,  3.76E-01,  3.56E-01,  3.37E-01,  3.17E-01,  2.97E-01,  2.77E-01,  2.57E-01,  2.38E-01,  2.18E-01,  1.98E-01,  1.78E-01,  1.58E-01,  1.39E-01,  1.19E-01,  9.90E-02,  7.92E-02,  5.94E-02,  3.97E-02,  1.98E-02,  0.00E+00];

%Epsilon_pre = 0.030

%x_def = [2.12E-02,  2.05E-02,  1.98E-02,  1.89E-02,  1.78E-02,  1.67E-02,  1.55E-02,  1.43E-02,  1.31E-02,  1.19E-02,  1.07E-02,  9.60E-03,  8.52E-03,  7.50E-03,  6.53E-03,  5.65E-03,  4.83E-03,  4.09E-03,  3.42E-03,  2.83E-03,  2.31E-03,  1.87E-03,  1.49E-03,  1.18E-03,  9.26E-04,  7.32E-04,  5.86E-04,  4.91E-04,  4.34E-04,  4.21E-04,  4.35E-04,  4.86E-04,  5.54E-04,  6.54E-04,  7.59E-04,  8.93E-04,  1.02E-03,  1.17E-03,  1.31E-03,  1.48E-03,  1.61E-03,  1.77E-03,  1.89E-03,  2.05E-03,  2.13E-03,  2.29E-03,  2.33E-03,  2.48E-03,  2.47E-03,  2.63E-03,  2.50E-03];
%y_def = [-1.74E-03,  1.78E-03,  4.85E-03,  7.34E-03,  9.53E-03,  1.13E-02,  1.29E-02,  1.42E-02,  1.53E-02,  1.62E-02,  1.71E-02,  1.77E-02,  1.83E-02,  1.87E-02,  1.91E-02,  1.94E-02,  1.96E-02,  1.98E-02,  1.99E-02,  2.00E-02,  2.01E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.03E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.02E-02,  2.01E-02,  2.02E-02,  2.02E-02,  2.00E-02];
%z_def = [9.82E-01,  9.63E-01,  9.43E-01,  9.24E-01,  9.05E-01,  8.85E-01,  8.66E-01,  8.46E-01,  8.26E-01,  8.07E-01,  7.87E-01,  7.68E-01,  7.48E-01,  7.28E-01,  7.09E-01,  6.89E-01,  6.69E-01,  6.50E-01,  6.30E-01,  6.11E-01,  5.91E-01,  5.71E-01,  5.52E-01,  5.32E-01,  5.12E-01,  4.92E-01,  4.73E-01,  4.53E-01,  4.33E-01,  4.14E-01,  3.94E-01,  3.74E-01,  3.55E-01,  3.35E-01,  3.15E-01,  2.96E-01,  2.76E-01,  2.56E-01,  2.37E-01,  2.17E-01,  1.97E-01,  1.77E-01,  1.58E-01,  1.38E-01,  1.18E-01,  9.86E-02,  7.89E-02,  5.91E-02,  3.95E-02,  1.97E-02,  0.00E+00];

% Epsilon_pre = 0.040

%x_def = [-5.86E-03,  -9.61E-03,  -1.29E-02,  -1.53E-02,  -1.71E-02,  -1.84E-02,  -1.93E-02,  -1.97E-02,  -1.99E-02,  -1.96E-02,  -1.90E-02,  -1.80E-02,  -1.68E-02,  -1.51E-02,  -1.33E-02,  -1.11E-02,  -8.85E-03,  -6.39E-03,  -3.85E-03,  -1.22E-03,  1.40E-03,  4.01E-03,  6.53E-03,  8.94E-03,  1.12E-02,  1.32E-02,  1.51E-02,  1.66E-02,  1.79E-02,  1.89E-02,  1.95E-02,  1.99E-02,  1.99E-02,  1.96E-02,  1.90E-02,  1.81E-02,  1.70E-02,  1.58E-02,  1.43E-02,  1.28E-02,  1.12E-02,  9.73E-03,  8.22E-03,  6.92E-03,  5.66E-03,  4.71E-03,  3.80E-03,  3.29E-03,  2.76E-03,  2.73E-03,  2.50E-03];
%y_def = [2.08E-02,  1.82E-02,  1.58E-02,  1.32E-02,  1.05E-02,  7.76E-03,  4.97E-03,  2.25E-03,  -5.40E-04,  -3.23E-03,  -5.91E-03,  -8.41E-03,  -1.08E-02,  -1.29E-02,  -1.49E-02,  -1.65E-02,  -1.78E-02,  -1.88E-02,  -1.95E-02,  -1.98E-02,  -1.98E-02,  -1.95E-02,  -1.88E-02,  -1.78E-02,  -1.64E-02,  -1.48E-02,  -1.30E-02,  -1.09E-02,  -8.67E-03,  -6.29E-03,  -3.82E-03,  -1.31E-03,  1.20E-03,  3.67E-03,  6.05E-03,  8.30E-03,  1.04E-02,  1.23E-02,  1.39E-02,  1.54E-02,  1.66E-02,  1.76E-02,  1.83E-02,  1.90E-02,  1.94E-02,  1.98E-02,  2.00E-02,  2.01E-02,  2.03E-02,  2.03E-02,  2.00E-02];
%z_def = [9.69E-01,  9.50E-01,  9.31E-01,  9.12E-01,  8.93E-01,  8.73E-01,  8.54E-01,  8.35E-01,  8.15E-01,  7.96E-01,  7.77E-01,  7.57E-01,  7.38E-01,  7.18E-01,  6.99E-01,  6.80E-01,  6.60E-01,  6.41E-01,  6.21E-01,  6.02E-01,  5.83E-01,  5.63E-01,  5.44E-01,  5.24E-01,  5.05E-01,  4.86E-01,  4.66E-01,  4.47E-01,  4.28E-01,  4.08E-01,  3.89E-01,  3.69E-01,  3.50E-01,  3.31E-01,  3.11E-01,  2.92E-01,  2.72E-01,  2.53E-01,  2.34E-01,  2.14E-01,  1.95E-01,  1.75E-01,  1.56E-01,  1.36E-01,  1.17E-01,  9.75E-02,  7.81E-02,  5.85E-02,  3.91E-02,  1.95E-02,  0.00E+00];

%Epsilon_pre = 0.050

%x_def = [2.18E-02,  2.01E-02,  1.82E-02,  1.58E-02,  1.30E-02,  1.01E-02,  6.94E-03,  3.70E-03,  3.08E-04,  -3.04E-03,  -6.36E-03,  -9.43E-03,  -1.23E-02,  -1.47E-02,  -1.68E-02,  -1.83E-02,  -1.93E-02,  -1.98E-02,  -1.97E-02,  -1.91E-02,  -1.79E-02,  -1.63E-02,  -1.42E-02,  -1.17E-02,  -8.84E-03,  -5.76E-03,  -2.54E-03,  7.71E-04,  4.03E-03,  7.20E-03,  1.01E-02,  1.28E-02,  1.51E-02,  1.70E-02,  1.85E-02,  1.94E-02,  1.98E-02,  1.98E-02,  1.91E-02,  1.81E-02,  1.66E-02,  1.50E-02,  1.30E-02,  1.11E-02,  9.01E-03,  7.28E-03,  5.52E-03,  4.35E-03,  3.20E-03,  2.90E-03,  2.50E-03];
%y_def = [9.21E-05,  4.96E-03,  9.28E-03,  1.25E-02,  1.52E-02,  1.71E-02,  1.86E-02,  1.94E-02,  1.99E-02,  1.96E-02,  1.88E-02,  1.75E-02,  1.56E-02,  1.33E-02,  1.07E-02,  7.68E-03,  4.53E-03,  1.22E-03,  -2.09E-03,  -5.36E-03,  -8.46E-03,  -1.13E-02,  -1.39E-02,  -1.60E-02,  -1.78E-02,  -1.90E-02,  -1.97E-02,  -1.98E-02,  -1.94E-02,  -1.85E-02,  -1.70E-02,  -1.51E-02,  -1.28E-02,  -1.02E-02,  -7.23E-03,  -4.13E-03,  -9.40E-04,  2.24E-03,  5.33E-03,  8.23E-03,  1.09E-02,  1.32E-02,  1.51E-02,  1.67E-02,  1.79E-02,  1.89E-02,  1.95E-02,  1.99E-02,  2.03E-02,  2.04E-02,  2.00E-02];
%z_def = [9.57E-01,  9.38E-01,  9.19E-01,  9.00E-01,  8.81E-01,  8.62E-01,  8.43E-01,  8.24E-01,  8.05E-01,  7.86E-01,  7.67E-01,  7.48E-01,  7.28E-01,  7.09E-01,  6.90E-01,  6.71E-01,  6.52E-01,  6.33E-01,  6.14E-01,  5.94E-01,  5.75E-01,  5.56E-01,  5.37E-01,  5.18E-01,  4.99E-01,  4.80E-01,  4.60E-01,  4.41E-01,  4.22E-01,  4.03E-01,  3.84E-01,  3.65E-01,  3.46E-01,  3.26E-01,  3.07E-01,  2.88E-01,  2.69E-01,  2.50E-01,  2.31E-01,  2.11E-01,  1.92E-01,  1.73E-01,  1.54E-01,  1.35E-01,  1.16E-01,  9.64E-02,  7.72E-02,  5.79E-02,  3.87E-02,  1.93E-02,  0.00E+00];


%% Thick widths
% Epsilon_pre = 0.2
%x_def = [7.91E-03,  -7.20E-04,  -9.56E-03,  -1.75E-02,  -2.07E-02,  -2.03E-02,  -1.80E-02,  -1.28E-02,  -5.92E-03,  2.24E-03,  9.89E-03,  1.61E-02,  1.98E-02,  2.05E-02,  1.81E-02,  1.29E-02,  5.85E-03,  -2.13E-03,  -9.81E-03,  -1.60E-02,  -1.97E-02,  -2.05E-02,  -1.82E-02,  -1.31E-02,  -6.00E-03,  2.01E-03,  9.65E-03,  1.59E-02,  1.97E-02,  2.05E-02,  1.82E-02,  1.32E-02,  6.10E-03,  -1.80E-03,  -9.60E-03,  -1.57E-02,  -1.97E-02,  -2.05E-02,  -1.83E-02,  -1.33E-02,  -6.43E-03,  1.74E-03,  9.06E-03,  1.60E-02,  1.95E-02,  2.21E-02,  1.94E-02,  1.78E-02,  1.10E-02,  9.68E-03,  6.25E-03];
%y_def = [1.94E-02,  1.95E-02,  1.82E-02,  1.25E-02,  4.72E-03,  -2.72E-03,  -9.87E-03,  -1.59E-02,  -1.97E-02,  -2.05E-02,  -1.81E-02,  -1.29E-02,  -5.79E-03,  2.24E-03,  9.86E-03,  1.60E-02,  1.98E-02,  2.05E-02,  1.81E-02,  1.30E-02,  5.92E-03,  -2.06E-03,  -9.74E-03,  -1.59E-02,  -1.97E-02,  -2.05E-02,  -1.82E-02,  -1.31E-02,  -6.07E-03,  1.93E-03,  9.61E-03,  1.58E-02,  1.97E-02,  2.05E-02,  1.83E-02,  1.32E-02,  6.19E-03,  -1.78E-03,  -9.46E-03,  -1.58E-02,  -1.96E-02,  -2.08E-02,  -1.85E-02,  -1.40E-02,  -7.20E-03,  5.11E-04,  7.91E-03,  1.49E-02,  1.97E-02,  2.16E-02,  2.00E-02];
%z_def = [7.80E-01,  7.69E-01,  7.54E-01,  7.38E-01,  7.23E-01,  7.08E-01,  6.92E-01,  6.76E-01,  6.60E-01,  6.44E-01,  6.28E-01,  6.13E-01,  5.97E-01,  5.81E-01,  5.66E-01,  5.50E-01,  5.34E-01,  5.18E-01,  5.02E-01,  4.87E-01,  4.71E-01,  4.55E-01,  4.39E-01,  4.24E-01,  4.08E-01,  3.92E-01,  3.76E-01,  3.61E-01,  3.45E-01,  3.29E-01,  3.13E-01,  2.98E-01,  2.82E-01,  2.66E-01,  2.50E-01,  2.35E-01,  2.19E-01,  2.03E-01,  1.87E-01,  1.72E-01,  1.56E-01,  1.40E-01,  1.24E-01,  1.09E-01,  9.30E-02,  7.71E-02,  6.18E-02,  4.56E-02,  3.12E-02,  1.47E-02,  0.00E+00];

% Epsilon_pre = 0.3
%x_def = [7.24E-03,  1.22E-02,  1.79E-02,  2.03E-02,  1.65E-02,  9.95E-03,  2.29E-03,  -6.34E-03,  -1.36E-02,  -1.87E-02,  -1.98E-02,  -1.72E-02,  -1.13E-02,  -3.20E-03,  5.47E-03,  1.31E-02,  1.82E-02,  1.99E-02,  1.77E-02,  1.22E-02,  4.34E-03,  -4.30E-03,  -1.22E-02,  -1.77E-02,  -1.99E-02,  -1.82E-02,  -1.31E-02,  -5.44E-03,  3.11E-03,  1.13E-02,  1.71E-02,  1.98E-02,  1.86E-02,  1.40E-02,  6.54E-03,  -1.90E-03,  -1.04E-02,  -1.64E-02,  -1.97E-02,  -1.90E-02,  -1.49E-02,  -7.65E-03,  4.71E-04,  9.49E-03,  1.56E-02,  2.14E-02,  2.01E-02,  2.04E-02,  1.20E-02,  1.13E-02,  6.25E-03];
%y_def = [-1.82E-02,  -1.26E-02,  -6.17E-03,  4.28E-03,  1.25E-02,  1.69E-02,  1.96E-02,  1.85E-02,  1.43E-02,  6.84E-03,  -1.67E-03,  -1.01E-02,  -1.64E-02,  -1.96E-02,  -1.91E-02,  -1.50E-02,  -7.95E-03,  5.55E-04,  8.99E-03,  1.57E-02,  1.94E-02,  1.94E-02,  1.57E-02,  9.01E-03,  6.05E-04,  -7.94E-03,  -1.49E-02,  -1.91E-02,  -1.96E-02,  -1.64E-02,  -1.01E-02,  -1.75E-03,  6.84E-03,  1.41E-02,  1.88E-02,  1.97E-02,  1.70E-02,  1.11E-02,  2.89E-03,  -5.78E-03,  -1.32E-02,  -1.85E-02,  -1.99E-02,  -1.82E-02,  -1.27E-02,  -4.84E-03,  3.81E-03,  1.30E-02,  2.00E-02,  2.22E-02,  2.00E-02];
%z_def = [6.80E-01,  6.72E-01,  6.60E-01,  6.46E-01,  6.33E-01,  6.19E-01,  6.05E-01,  5.91E-01,  5.77E-01,  5.63E-01,  5.49E-01,  5.35E-01,  5.22E-01,  5.08E-01,  4.94E-01,  4.80E-01,  4.67E-01,  4.53E-01,  4.39E-01,  4.25E-01,  4.11E-01,  3.97E-01,  3.84E-01,  3.70E-01,  3.56E-01,  3.42E-01,  3.28E-01,  3.15E-01,  3.01E-01,  2.87E-01,  2.73E-01,  2.59E-01,  2.46E-01,  2.32E-01,  2.18E-01,  2.04E-01,  1.91E-01,  1.77E-01,  1.63E-01,  1.49E-01,  1.35E-01,  1.22E-01,  1.08E-01,  9.42E-02,  8.01E-02,  6.63E-02,  5.33E-02,  3.86E-02,  2.71E-02,  1.20E-02,  0.00E+00];


% Epsilon_pre = 0.4
%x_def = [-7.08E-03,  -1.48E-03,  5.83E-03,  1.54E-02,  1.92E-02,  1.77E-02,  1.47E-02,  7.91E-03,  3.51E-04,  -8.40E-03,  -1.46E-02,  -1.82E-02,  -1.77E-02,  -1.38E-02,  -6.92E-03,  1.17E-03,  9.26E-03,  1.53E-02,  1.83E-02,  1.74E-02,  1.30E-02,  5.96E-03,  -2.34E-03,  -1.01E-02,  -1.59E-02,  -1.83E-02,  -1.71E-02,  -1.22E-02,  -4.99E-03,  3.49E-03,  1.09E-02,  1.64E-02,  1.84E-02,  1.66E-02,  1.14E-02,  3.99E-03,  -4.63E-03,  -1.17E-02,  -1.70E-02,  -1.84E-02,  -1.61E-02,  -1.05E-02,  -3.09E-03,  5.80E-03,  1.24E-02,  1.97E-02,  1.96E-02,  2.19E-02,  1.23E-02,  1.28E-02,  6.25E-03];
%y_def = [-1.61E-02,  -1.52E-02,  -1.60E-02,  -1.16E-02,  -3.62E-03,  3.83E-03,  1.10E-02,  1.62E-02,  1.81E-02,  1.64E-02,  1.11E-02,  3.45E-03,  -4.93E-03,  -1.22E-02,  -1.70E-02,  -1.83E-02,  -1.59E-02,  -1.02E-02,  -2.40E-03,  5.89E-03,  1.30E-02,  1.74E-02,  1.82E-02,  1.53E-02,  9.29E-03,  1.31E-03,  -6.88E-03,  -1.38E-02,  -1.77E-02,  -1.81E-02,  -1.47E-02,  -8.30E-03,  -2.56E-04,  7.87E-03,  1.45E-02,  1.79E-02,  1.79E-02,  1.40E-02,  7.30E-03,  -8.59E-04,  -8.83E-03,  -1.54E-02,  -1.81E-02,  -1.81E-02,  -1.39E-02,  -6.90E-03,  1.61E-03,  1.25E-02,  2.08E-02,  2.26E-02,  2.00E-02];
%z_def = [5.92E-01,  5.87E-01,  5.78E-01,  5.65E-01,  5.54E-01,  5.42E-01,  5.29E-01,  5.17E-01,  5.05E-01,  4.93E-01,  4.81E-01,  4.68E-01,  4.56E-01,  4.44E-01,  4.32E-01,  4.20E-01,  4.08E-01,  3.96E-01,  3.84E-01,  3.72E-01,  3.59E-01,  3.47E-01,  3.35E-01,  3.23E-01,  3.11E-01,  2.99E-01,  2.87E-01,  2.75E-01,  2.62E-01,  2.50E-01,  2.38E-01,  2.26E-01,  2.14E-01,  2.02E-01,  1.90E-01,  1.77E-01,  1.66E-01,  1.53E-01,  1.42E-01,  1.29E-01,  1.17E-01,  1.05E-01,  9.27E-02,  8.13E-02,  6.84E-02,  5.68E-02,  4.56E-02,  3.23E-02,  2.34E-02,  9.40E-03,  0.00E+00];

% Epsilon_pre = 0.5
%x_def = [-5.77E-03,  -1.72E-03,  3.43E-03,  1.24E-02,  1.72E-02,  1.60E-02,  1.40E-02,  8.44E-03,  2.14E-03,  -5.94E-03,  -1.17E-02,  -1.58E-02,  -1.59E-02,  -1.33E-02,  -7.48E-03,  -6.15E-04,  6.81E-03,  1.25E-02,  1.58E-02,  1.57E-02,  1.25E-02,  6.60E-03,  -5.87E-04,  -7.71E-03,  -1.32E-02,  -1.60E-02,  -1.55E-02,  -1.17E-02,  -5.66E-03,  1.74E-03,  8.58E-03,  1.38E-02,  1.61E-02,  1.51E-02,  1.10E-02,  4.66E-03,  -2.89E-03,  -9.33E-03,  -1.44E-02,  -1.62E-02,  -1.47E-02,  -1.02E-02,  -3.69E-03,  4.16E-03,  1.05E-02,  1.83E-02,  1.88E-02,  2.25E-02,  1.23E-02,  1.41E-02,  6.25E-03];
%y_def = [-1.41E-02,  -1.26E-02,  -1.45E-02,  -1.16E-02,  -4.93E-03,  1.59E-03,  8.23E-03,  1.33E-02,  1.55E-02,  1.52E-02,  1.10E-02,  4.67E-03,  -2.80E-03,  -9.40E-03,  -1.43E-02,  -1.61E-02,  -1.47E-02,  -1.02E-02,  -3.60E-03,  3.73E-03,  1.03E-02,  1.48E-02,  1.62E-02,  1.42E-02,  9.38E-03,  2.53E-03,  -4.74E-03,  -1.12E-02,  -1.51E-02,  -1.61E-02,  -1.37E-02,  -8.44E-03,  -1.48E-03,  5.76E-03,  1.20E-02,  1.54E-02,  1.61E-02,  1.30E-02,  7.50E-03,  3.71E-04,  -6.76E-03,  -1.30E-02,  -1.57E-02,  -1.64E-02,  -1.31E-02,  -6.91E-03,  9.58E-04,  1.30E-02,  2.18E-02,  2.30E-02,  2.00E-02];
%z_def = [5.17E-01,  5.12E-01,  5.08E-01,  4.94E-01,  4.86E-01,  4.75E-01,  4.64E-01,  4.53E-01,  4.42E-01,  4.32E-01,  4.21E-01,  4.10E-01,  4.00E-01,  3.89E-01,  3.78E-01,  3.68E-01,  3.57E-01,  3.46E-01,  3.36E-01,  3.25E-01,  3.14E-01,  3.04E-01,  2.93E-01,  2.82E-01,  2.72E-01,  2.61E-01,  2.50E-01,  2.40E-01,  2.29E-01,  2.19E-01,  2.08E-01,  1.97E-01,  1.86E-01,  1.76E-01,  1.65E-01,  1.54E-01,  1.44E-01,  1.33E-01,  1.23E-01,  1.12E-01,  1.01E-01,  9.07E-02,  7.97E-02,  6.99E-02,  5.81E-02,  4.84E-02,  3.88E-02,  2.68E-02,  2.00E-02,  6.98E-03,  0.00E+00];


%% Code to find tau
% Using arctan2(y,x) to find the angle (in radians) between the deformed x coordinates and the y deformed coordinates
theta_def = atan2(y_def, x_def); 

% Unwrapping the angle to determine the 'true' angles displaced
theta_def_unwrapped = unwrap(theta_def); 

% Finding the total twist by accumulating the unwrapped angles
total_twist = theta_def_unwrapped(end) - theta_def_unwrapped(1);

% Determining the arc length of the helix formed
L_arc = z_def(1) - z_def(end);  

% Defining the initial length of the structure
L = 1;

% Finding the twist per unit length
tau = total_twist / L;

% Finding the number of rotations the helix makes
turns = total_twist / (2 * pi);


%% 3D Plot showing helical shape

figure;
plot3(x_def, y_def, z_def, 'b.-', 'LineWidth', 1.5);
xlabel('x'); ylabel('y'); zlabel('z');
title('Helical shape using unwrapped angles');
grid on;
axis equal;
view(3);
